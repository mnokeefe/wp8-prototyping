!function(t){function e(e,n){if(this.defaults={debug:!1,clickedWrapperClass:"ui-panorama-click-wrapper",clickedWrapperZindex:2,clickedElementClass:"ui-panorama-clicked",animationDuration:500,animationEasing:"easeOutExpo",titleSelector:"h1",itemsContainerSelector:".ui-panorama-items",itemSelector:".ui-panorama-item",backgroundAnimationStep:0,titleAnimationStep:15,itemsGapPercentage:10,waitXpercentage:5,waitYpercentage:5,backPointPercentage:10,itemsLeftMarginPercent:0,totalNumberOfItems:0,controlInitializedEventName:"controlInitialized",selectedItemChangedEventName:"selectedItemChanged"},!t(e).data("panorama")){t(e).css({"-ms-content-zooming":"none","-ms-touch-action":"none"}),this.opts=t.extend({},this.defaults,n),this.opts=t.extend(this.opts,{currentIndex:0,busy:!1,_item_width:0,eventsSettings:{useSetReleaseCapture:!1,lastXYById:{},moved:0,yDirection:null},debug:1==this.opts.debug&&t("<div>").css({position:"fixed",bottom:"0px",right:"0px",background:"white",border:"1px solid red",overflow:"hidden",width:"200px",height:"20%",zIndex:"9999",color:"black"}).appendTo("body")});var s=t(window).width()/100;if(this.opts.waitXpercentage=Math.round(s*this.opts.waitXpercentage),this.opts.waitYpercentage=Math.round(s*this.opts.waitYpercentage),this.opts.backPointPercentage=Math.round(s*this.opts.backPointPercentage),0==parseInt(this.opts.totalNumberOfItems)&&(this.opts.totalNumberOfItems=t(e).children(this.opts.itemsContainerSelector).children(this.opts.itemSelector).length),0==parseInt(this.opts.backgroundAnimationStep)&&(this.opts.backgroundAnimationStep=Math.round(100/this.opts.totalNumberOfItems)),this.$el=t(e),t("<div>").addClass(this.opts.clickedWrapperClass).css({zIndex:this.opts.clickedWrapperZindex,opacity:"0",width:t(window).width(),height:t(window).height(),position:"fixed",left:"0px",top:"0px",background:"black",overflow:"scroll"}).prependTo(this.$el),this.opts.debug){var o=t("<div>").css({position:"fixed",bottom:"0px",left:"0px",background:"white",border:"1px solid red",color:"black"}).appendTo("body");t("<h2>").html('<a href="#" onclick="$(\'.'+this.$el.attr("class")+"').data('obj').goToNext();\">swipe left</a>").appendTo(o),t("<h2>").html('<a href="#" onclick="$(\'.'+this.$el.attr("class")+"').data('obj').goToPrevious();\">swipe right</a>").appendTo(o),t("<h2>").html('<a href="#" onclick="$(\'.'+this.$el.attr("class")+"').data('obj').goTo(3);\">go to screen 3</a>").appendTo(o),t("<h2>").html('<a href="#" onclick="alert($(\'.'+this.$el.attr("class")+"').data('obj').opts.currentIndex);\">get current idx</a>").appendTo(o)}this.getItemsContainer=function(){return this.$el.children(this.opts.itemsContainerSelector)},this.getItems=function(){return this.getItemsContainer().children(this.opts.itemSelector)},this.getItem=function(t){return this.getItemsContainer().children(this.opts.itemSelector+":eq("+t+")")},this.getLastItem=function(){return this.getItem(this.opts.totalNumberOfItems-1)},this.getTitle=function(){return this.$el.children(this.opts.titleSelector)},this.fixIndex=function(t){return 0>t?t+=this.opts.totalNumberOfItems:t>=this.opts.totalNumberOfItems&&(t-=this.opts.totalNumberOfItems),t},this.getCurrentItem=function(){return this.getItems().eq(this.opts.currentIndex)},this.goTo=function(t){var e=this,n=setInterval(function(){e.opts.currentIndex==t?clearInterval(n):e.opts.currentIndex<t?e.goToNext():e.goToPrevious()},e.opts.animationDuration)},this.goToNext=function(){this.changeItem(!0)},this.goToPrevious=function(){this.changeItem(!1)},this.setEvents=function(e){function n(t){for(var e=0,n=0,s=t;null!=s;s=s.offsetParent)navigator.userAgent.match(/\bMSIE\b/)&&(!document.documentMode||document.documentMode<8)&&"relative"==s.currentStyle.position&&s.offsetParent&&"relative"==s.offsetParent.currentStyle.position&&s.offsetLeft==s.offsetParent.offsetLeft?n+=s.offsetTop:(e+=s.offsetLeft,n+=s.offsetTop);return{x:e,y:n}}function s(t){if(Object.keys)return Object.keys(t).length;var e=0;for(var n in t)++e;return e}function o(t){if("undefined"==typeof t.pageX)if(t.pageX=t.offsetX+documentToTargetDelta.x,t.pageY=t.offsetY+documentToTargetDelta.y,t.srcElement.offsetParent==e&&document.documentMode&&8==document.documentMode&&"mousedown"==t.type)t.pageX+=t.srcElement.offsetLeft,t.pageY+=t.srcElement.offsetTop;else if(t.srcElement!=e&&!document.documentMode||document.documentMode<8){for(var n=-2,s=-2,o=t.srcElement;null!=o;o=o.parentNode)n+=o.scrollLeft?o.scrollLeft:0,s+=o.scrollTop?o.scrollTop:0;t.pageX=t.clientX+n,t.pageY=t.clientY+s}}function i(u){if("mousemove"!=u.type||0!=s(a.opts.eventsSettings.lastXYById)){u.preventDefault&&u.preventDefault(),u.preventManipulation&&u.preventManipulation(),u.preventMouseEvent&&u.preventMouseEvent();for(var c=u.changedTouches?u.changedTouches:[u],m=0;m<c.length;++m){var l=c[m],g="undefined"!=typeof l.identifier?l.identifier:"undefined"!=typeof l.pointerId?l.pointerId:1;o(l);var f=l.pageX,v=l.pageY;if(u.type.match(/(start|down)$/i)){if(a.opts.eventsSettings.moved=0,documentToTargetDelta=n(e),a.opts.eventsSettings.lastXYById[g])return delete a.opts.eventsSettings.lastXYById[g],a.opts.debug&&t("<div>").html("force end").prependTo(a.opts.debug),a.getItemsContainer().css({left:"0px"}),void 0;a.opts.debug&&t("<div>").html("start at "+f+"px").prependTo(a.opts.debug),a.opts.eventsSettings.lastXYById[g]={x:f,y:v},r=f,d=v,e.msSetPointerCapture?e.msSetPointerCapture(g):"mousedown"==u.type&&1==s(a.opts.eventsSettings.lastXYById)&&(a.opts.eventsSettings.useSetReleaseCapture?e.setCapture(!0):(document.addEventListener("mousemove",i,!1),document.addEventListener("mouseup",i,!1))),t("."+a.opts.clickedWrapperClass).hide(),t(document.elementFromPoint(f,v)).addClass(a.opts.clickedElementClass),t("."+a.opts.clickedWrapperClass).show()}else if(u.type.match(/move$/i)){if(void 0!==a.opts.eventsSettings.lastXYById[g]){a.opts.eventsSettings.lastXYById[g].x=f,a.opts.eventsSettings.lastXYById[g].y=v,p=f-r,h=d-v,mNewX=Math.abs(p),mNewY=Math.abs(h);var I=a.opts.waitXpercentage,b=a.opts.waitYpercentage;mNewY>b&&I>mNewX?(h>0&&"up"!=a.opts.eventsSettings.yDirection?(h-=b,a.opts.eventsSettings.yDirection="down"):(h+=b,a.opts.eventsSettings.yDirection="up"),0==a.opts.busy&&(h+=a.getItem(a.opts.currentIndex).scrollTop(),d+=a.getItem(a.opts.currentIndex).scrollTop()),a.opts.busy=!0,a.getItem(a.opts.currentIndex).scrollTop(h),a.opts.eventsSettings.moved=h,a.opts.debug&&t("<div>").html("going "+a.opts.eventsSettings.yDirection+": "+h).prependTo(a.opts.debug),p=0):mNewX>I?(0>p&&(I=-I),a.opts.eventsSettings.moved=p-I,a.opts.debug&&t("<div>").html("move: "+a.opts.eventsSettings.moved+"px").prependTo(a.opts.debug),0==a.opts.busy&&a.getItemsContainer().css({left:a.opts.eventsSettings.moved+"px"})):(p=0,h=0,a.opts.eventsSettings.moved=0)}}else if(a.opts.eventsSettings.lastXYById[g]&&u.type.match(/(up|end|cancel)$/i)){delete a.opts.eventsSettings.lastXYById[g],e.msReleasePointerCapture?e.msReleasePointerCapture(g):"mouseup"==u.type&&0==s(a.opts.eventsSettings.lastXYById)&&(a.opts.eventsSettings.useSetReleaseCapture?e.releaseCapture():(document.removeEventListener("mousemove",i,!1),document.removeEventListener("mouseup",i,!1))),a.opts.debug&&t("<div>").html("end").prependTo(a.opts.debug),null!=a.opts.eventsSettings.yDirection&&(a.opts.eventsSettings.yDirection=null,a.opts.busy=!1);var w=setInterval(function(){0==a.opts.busy&&(clearInterval(w),p>0?(p<a.opts.backPointPercentage?a.getItemsContainer().animate({left:"0px"},a.opts.animationDuration,a.opts.animationEasing):a.goToPrevious(),p=0):0>p&&(p>-a.opts.backPointPercentage?a.getItemsContainer().animate({left:"0px"},a.opts.animationDuration,a.opts.animationEasing):a.goToNext(),p=0))},10);setTimeout(function(){t("."+a.opts.clickedElementClass).each(function(){t(this).removeClass(a.opts.clickedElementClass),(0==a.opts.eventsSettings.moved||void 0===a.opts.eventsSettings.moved)&&t(this).click()}),null==a.opts.eventsSettings.yDirection&&(a.opts.eventsSettings.moved=0)},100)}}}}var a=this;if(window.navigator.msPointerEnabled)e.addEventListener("MSPointerDown",i,!1),e.addEventListener("MSPointerMove",i,!1),e.addEventListener("MSPointerUp",i,!1),e.addEventListener("MSPointerCancel",i,!1),"undefined"!=typeof e.style.msContentZooming&&(e.style.msContentZooming="none"),"undefined"!=typeof e.style.msTouchAction&&(e.style.msTouchAction="none"),a.opts.debug&&t("<div>").html("Using Microsoft pointer model").prependTo(a.opts.debug);else if(e.addEventListener)e.addEventListener("touchstart",i,!1),e.addEventListener("touchmove",i,!1),e.addEventListener("touchend",i,!1),e.addEventListener("touchcancel",i,!1),e.addEventListener("mousedown",i,!1),e.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(this.opts.eventsSettings.useSetReleaseCapture=!0,e.addEventListener("mousemove",i,!1),e.addEventListener("mouseup",i,!1)),a.opts.debug&&t("<div>").html("Using mouse model with capture").prependTo(a.opts.debug);else{if(!e.attachEvent||!e.setCapture)return a.opts.debug&&t("<div>").html("Unexpected combination of supported features").prependTo(a.opts.debug),!1;a.opts.eventsSettings.useSetReleaseCapture=!0,e.attachEvent("onmousedown",function(){return i(window.event),window.event.returnValue=!1,!1}),e.attachEvent("onmousemove",function(){return i(window.event),window.event.returnValue=!1,!1}),e.attachEvent("onmouseup",function(){return i(window.event),window.event.returnValue=!1,!1}),a.opts.debug&&t("<div>").html("Using legacy IE mode - mouse model with capture").prependTo(a.opts.debug)}var r,p,d,h;return this.$el.data("obj",a),this.$el.trigger(a.opts.controlInitializedEventName),!0},this.changeItem=function(e){if(this.opts.busy)return!1;this.opts.busy=!0,this.opts.debug&&(e?t("<div>").html("swipe left").prependTo(this.opts.debug):t("<div>").html("swipe right").prependTo(this.opts.debug));var n,s,o=this.getItem(this.opts.currentIndex);s=this.fixIndex(e?this.opts.currentIndex+1:this.opts.currentIndex-1),n=this.fixIndex(e?this.opts.currentIndex+2:this.opts.currentIndex+1);var i,a,r=this.getItem(s),p=this.totalNumberOfItems>2?this.getItem(n):void 0;!e&&r&&(r.css({left:-this.opts._item_width+this.opts.itemsLeftMarginPercent}),this.totalNumberOfItems>3&&(i=this.fixIndex(s-1),a=this.getItem(i),this.getItems().not(":eq("+this.opts.currentIndex+")").not(":eq("+s+")").not(":eq("+i+")").hide(),this.getItem(this.fixIndex(s-1)).css({left:-this.opts._item_width+this.opts.itemsLeftMarginPercent}))),e&&p&&(p.css({left:2*this.opts._item_width+this.opts.itemsLeftMarginPercent}),this.getItems().not(":eq("+this.opts.currentIndex+")").not(":eq("+n+")").hide());var d={left:(e?"-=":"+=")+this.opts._item_width},h=this,u=function(){h.opts.currentIndex=s,a&&a.show(),h.opts.busy=!1,h.opts.eventsSettings.lastXYById={},h.$el.trigger(h.opts.selectedItemChangedEventName)};return r&&r.show(),p&&p.show(),r&&r.animate(d,this.opts.animationDuration,this.opts.animationEasing,u),p&&p.animate(d,this.opts.animationDuration,this.opts.animationEasing),o.animate(d,this.opts.animationDuration,this.opts.animationEasing),this.getItemsContainer().animate({left:"0px"},this.opts.anumationDuration,this.opts.animationEasing),this.opts.titleSelector&&this.getTitle().animate({marginLeft:-s*this.opts.titleAnimationStep+"%"},this.opts.animationDuration,this.opts.animationEasing),this.$el.animate({backgroundPositionX:s*this.opts.backgroundAnimationStep+"%"},this.opts.animationDuration,this.opts.animationEasing),!0}}}e.prototype={init:function(){var t=this;return t.$el?(t.$el.attr("data-panorama",!0),this.prepare(t.$el),!0):!1},prepare:function(e){var n=t(window).height(),s=this.getItemsContainer().position().top,o=n-s;e.height(o),this.getItemsContainer().height(o),this.totalNumberOfItems=this.getItems().length;var i=e.outerWidth(),a=i*(100-this.opts.itemsGapPercentage)/100;this.opts._item_width=a;var r=Math.round(t(window).width()/100*this.opts.itemsLeftMarginPercent);this.opts.itemsLeftMarginPercent=r,this.getItems().each(function(e,n){t(n).height(o-(t(n).outerHeight()-t(n).height())),t(n).width(a-(t(n).outerWidth()-t(n).width())),1==e&&t(n).css({left:a}),e>1&&t(n).hide()}),this.opts.totalNumberOfItems>2&&(this.getLastItem().css({left:"-"+a+"px"}).show(),this.getItems().css("left","+="+r+"px"))},show:function(){var e=this;this.getItemsContainer().fadeIn(function(){var n=e.getItemsContainer().position().top;e.getItems().each(function(){t(this).css("height","-="+n+"px")})})}},t.fn.panorama=function(n){this.length&&this.each(function(){var s=new e(this,n);s.init()&&(s.setEvents(this),s.show(),t(this).data("panorama",s))})}}(jQuery),$.easing.easeOutExpo=function(t,e,n,s,o){return e==o?n+s:s*(-Math.pow(2,-10*e/o)+1)+n};